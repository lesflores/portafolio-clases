# ============================
# Contingencia + Chi2
# Datos: gss_cat (forcats)
# Profesora: Lesly Flores
# ============================

# install.packages("forcats") 猬
library(forcats)
library(dplyr)

# (1) Datos de la General Social Survey (incluido en forcats)
gss <- gss_cat
View(gss)
summary(gss)

# (2) Tabla de conteos (frecuencias absolutas)
tab <- table(gss$partyid, gss$marital)
tab
# Filas = partido pol铆tico
# Columnas = estado civil

# (3) Prueba Chi2 (驴hay relaci贸n entre las variables?)
chisq.test(tab)

# El valor de X-squared indica cu谩nto difieren los datos observados
# de los que esperar铆amos si no hubiera relaci贸n entre las variables.
# df = grados de libertad, seg煤n el n煤mero de categor铆as.
# p-value < 0.05 significa que rechazamos la hip贸tesis nula de independencia.
# En este caso s铆 hay evidencia de que partido y estado civil est谩n asociados.

# (4) Porcentajes por FILA (cada partido = 100%)
# Te dice: dentro de cada partido, c贸mo se reparte el estado civil

prop_fila <- prop.table(tab, 1) * 100
prop_fila_df <- as.data.frame.matrix(round(prop_fila, 1))
prop_fila_df

# (5) Porcentajes por COLUMNA (cada estado civil = 100%)
# Te dice: dentro de cada estado civil, c贸mo se reparten los partidos
prop_col <- prop.table(tab, 2) * 100
prop_col_df <- as.data.frame.matrix(round(prop_col, 1))
prop_col_df
